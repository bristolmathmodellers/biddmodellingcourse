<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 2: Compartmental Models to Equations â€¢ BIDD Modelling Course</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">biddmodellingcourse</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/practical_1.html">Practical 1 - Designing a Model</a>
    </li>
    <li>
      <a href="../articles/practical_2.html">Practical 2 - Compartmental Models to Equations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Solutions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/practical_1.html">Solutions 1 - Designing a Model</a>
    </li>
    <li>
      <a href="../articles/practical_2.html">Solutions 2 - Compartmental Models to Equations</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Fact Sheets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tb_fact_sheet.html">Tuberculosis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="https://github.com/bristolmathmodellers/biddmodellingcourse/">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Practical 2: Compartmental Models to Equations</h1>
                        <h4 class="author">Sam Abbott</h4>
            
          </div>

    
    
<div class="contents">
<div id="learning-objectives" class="section level1">
<h1 class="hasAnchor">
<a href="#learning-objectives" class="anchor"></a>Learning Objectives</h1>
<ol style="list-style-type: decimal">
<li>How to translate a simple model flow diagram into equations</li>
<li>Understand how changing parameter values can change model dynamics</li>
<li>Using a simple model scaffold to develop a more complex model</li>
</ol>
</div>
<div id="outline-for-session" class="section level1">
<h1 class="hasAnchor">
<a href="#outline-for-session" class="anchor"></a>Outline for Session</h1>
<ol style="list-style-type: decimal">
<li>Set up (5 minutes)</li>
<li>Explore the dynamics of a simple SEIR model (10 minutes)</li>
<li>Add high and low risk latency to a SEIR model (10 minutes)</li>
<li>Explore SHLIR model dynamics and compare to the SEIR model (10 minutes)</li>
<li>Extension: Translate your Model Flow Diagram to Equations (20 minutes)</li>
<li>Extension: Explore the parameter space of multiple models (20 minutes)(If having trouble with the previous excercises then skip to this point for an R free exercise)</li>
<li>Session wrap up (10 minutes)</li>
</ol>
</div>
<div id="excercises" class="section level1">
<h1 class="hasAnchor">
<a href="#excercises" class="anchor"></a>Excercises</h1>
<div id="a-simple-seir-model-of-tuberculosis-tb" class="section level2">
<h2 class="hasAnchor">
<a href="#a-simple-seir-model-of-tuberculosis-tb" class="anchor"></a>A Simple SEIR Model of Tuberculosis (TB)</h2>
<p>As a first excericse we are going to run the simple SEIR model, as seen in the design a model practical, in R. As a first step you will need to load the following packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(biddmodellingcourse)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(prettypublisher)</code></pre></div>
<div id="populations-and-initialisation" class="section level3">
<h3 class="hasAnchor">
<a href="#populations-and-initialisation" class="anchor"></a>Populations and Initialisation</h3>
<p>We first set up the initial populations for the Susceptible (<span class="math inline">\(S_0\)</span>), Latent (<span class="math inline">\(E_0\)</span>), Infected (<span class="math inline">\(I\)</span>), and Recovered (<span class="math inline">\(R\)</span>) compartments. We have initialised the model as an early stage epidemic with a single case of TB.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inits =<span class="st"> </span><span class="kw">c</span>(
  <span class="dt">S =</span> <span class="dv">999</span>,
  <span class="dt">E =</span> <span class="dv">0</span>,
  <span class="dt">I =</span> <span class="dv">1</span>,
  <span class="dt">R =</span> <span class="dv">0</span>
)</code></pre></div>
</div>
<div id="parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters" class="anchor"></a>Parameters</h3>
<p>We then specify the model parameters (with the units being years), varying these paremeters will impact the model dynamics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">parameters &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="dt">beta =</span> <span class="dv">3</span>, <span class="co"># Rate of transmission</span>
  <span class="dt">gamma =</span> <span class="dv">2</span>, <span class="co"># Rate of progression to active symptoms </span>
  <span class="dt">tau =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="co"># Rate of recovery</span>
  <span class="dt">mu =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">81</span> <span class="co"># Rate of natural mortality</span>
)</code></pre></div>
</div>
<div id="equations" class="section level3">
<h3 class="hasAnchor">
<a href="#equations" class="anchor"></a>Equations</h3>
<p>Finally we specify the model equations for each population compartment. This is model incorperates simple demographic processes with a constant natural death rate from all compartments which is equal to the birth rate into the susceptible compartment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SEIR_demo_ode &lt;-<span class="st"> </span><span class="cf">function</span>(t, x, params) {

  ## Specify model compartments
  S &lt;-<span class="st"> </span>x[<span class="dv">1</span>]
  E &lt;-<span class="st"> </span>x[<span class="dv">2</span>]
  I &lt;-<span class="st"> </span>x[<span class="dv">3</span>]
  R &lt;-<span class="st"> </span>x[<span class="dv">4</span>]

  <span class="kw">with</span>(<span class="kw">as.list</span>(params),{

    ## Specify total population
    N =<span class="st"> </span>S <span class="op">+</span><span class="st"> </span>E <span class="op">+</span><span class="st"> </span>I <span class="op">+</span><span class="st"> </span>R

    ## Derivative Expressions
    dS =<span class="st"> </span><span class="op">-</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>N
    dE =<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N <span class="op">-</span><span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>E <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>E
    dI =<span class="st"> </span>gamma <span class="op">*</span><span class="st"> </span>E <span class="op">-</span><span class="st"> </span>tau <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>I
    dR =<span class="st"> </span>tau <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>R

    ## output
    derivatives &lt;-<span class="st"> </span><span class="kw">c</span>(dS, dE, dI, dR)

    <span class="kw">list</span>(derivatives)
  })
}</code></pre></div>
</div>
<div id="simulate-and-summarise" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-and-summarise" class="anchor"></a>Simulate and Summarise</h3>
<p>To simulate the model we specify the starting year (<code>begin_time</code>) and final year (<code>end_time</code>) and define a sequence over all intervening years. The model is then solved using <code><a href="http://www.rdocumentation.org/packages/deSolve/topics/lsoda">deSolve::lsoda</a></code> which is used within a simple wrapper function (see <code><a href="../reference/solve_ode.html">?solve_ode</a></code> for details). The resulting table summarises the simulation results for the first 5 years.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">begin_time &lt;-<span class="st"> </span><span class="dv">0</span>
end_time &lt;-<span class="st"> </span><span class="dv">200</span>
times &lt;-<span class="st"> </span><span class="kw">seq</span>(begin_time, end_time, <span class="dv">1</span>)

## see ?solve_ode for details
SEIR_sim &lt;-<span class="st"> </span>biddmodellingcourse<span class="op">::</span><span class="kw"><a href="https://bristolmathmodellers.github.io/biddmodellingcourse//reference/solve_ode.html">solve_ode</a></span>(<span class="dt">model =</span> SEIR_demo_ode, 
                                           <span class="dt">inits =</span> inits, 
                                           <span class="dt">params =</span> parameters,
                                           <span class="dt">times =</span> times, 
                                           <span class="dt">as.data.frame =</span> <span class="ot">TRUE</span>)
SEIR_sim <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/prettypublisher/topics/pretty_table">pretty_table</a></span>(<span class="dt">caption =</span> <span class="st">"First 5 years of model simulation"</span>,
               <span class="dt">label =</span> <span class="st">"tab-1"</span>)</code></pre></div>
<table style="width:54%;" class="table">
<caption>Table 1: First 5 years of model simulation</caption>
<colgroup>
<col width="9%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">time</th>
<th align="center">S</th>
<th align="center">E</th>
<th align="center">I</th>
<th align="center">R</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">999</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">994.8</td>
<td align="center">2.123</td>
<td align="center">2.372</td>
<td align="center">0.7042</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">980.6</td>
<td align="center">7.697</td>
<td align="center">8.584</td>
<td align="center">3.099</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">931.5</td>
<td align="center">26.49</td>
<td align="center">30.33</td>
<td align="center">11.67</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">783.3</td>
<td align="center">78.18</td>
<td align="center">97.97</td>
<td align="center">40.58</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">479.7</td>
<td align="center">151.5</td>
<td align="center">246.2</td>
<td align="center">122.6</td>
</tr>
</tbody>
</table>
<p>We then summarise the epidemic peak (<code>epi_peak</code>) and epidemic duration (<code>epi_dur</code>), along with population sizes at the end of the time period simulated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">biddmodellingcourse<span class="op">::</span><span class="kw"><a href="https://bristolmathmodellers.github.io/biddmodellingcourse//reference/summarise_model.html">summarise_model</a></span>(SEIR_sim) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/prettypublisher/topics/pretty_table">pretty_table</a></span>(<span class="dt">caption =</span> <span class="st">"SEIR model summary statistics; The final size of each population at the end of the simulation, along with the time the epidemic peak was reached, the number of infected at the epidemic peak and the duration of the epidemic"</span>)</code></pre></div>
<table style="width:86%;" class="table">
<caption>Table 2: SEIR model summary statistics; The final size of each population at the end of the simulation, along with the time the epidemic peak was reached, the number of infected at the epidemic peak and the duration of the epidemic</caption>
<colgroup>
<col width="8%">
<col width="5%">
<col width="6%">
<col width="8%">
<col width="22%">
<col width="22%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">S</th>
<th align="center">E</th>
<th align="center">I</th>
<th align="center">R</th>
<th align="center">epi_peak_time</th>
<th align="center">epi_peak_size</th>
<th align="center">epi_dur</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">172</td>
<td align="center">5</td>
<td align="center">20</td>
<td align="center">803</td>
<td align="center">6</td>
<td align="center">391</td>
<td align="center">Inf</td>
</tr></tbody>
</table>
<p>Finally we plot the population in each model compartment over time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## For an interactive graph change interactive to TRUE
biddmodellingcourse<span class="op">::</span><span class="kw"><a href="https://bristolmathmodellers.github.io/biddmodellingcourse//reference/plot_model.html">plot_model</a></span>(SEIR_sim, <span class="dt">interactive =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="figure">
<img src="practical_2_files/figure-html/seir-plot-1.png" alt="Figure 1: Plot of population over time in each SEIR model compartment" width="672"><p class="caption">
Figure 1: Plot of population over time in each SEIR model compartment
</p>
</div>
</div>
<div id="explore" class="section level3">
<h3 class="hasAnchor">
<a href="#explore" class="anchor"></a>Explore</h3>
<p>Model dynamics are parameter dependent. Even in a simplistic model like the one outlined above parameter values can greatly alter the dynamics. Answer the following questions by varying the parameters above and rerunning the model.</p>
<ol style="list-style-type: decimal">
<li><p>What is the impact of adding demographic processes (births and deaths)?</p></li>
<li><p>What happens when the transmission rate (beta) is reduced below 1?</p></li>
<li><p>What happens as the rate of recovery is increased?</p></li>
</ol>
</div>
</div>
<div id="add-high-and-low-risk-compartments" class="section level2">
<h2 class="hasAnchor">
<a href="#add-high-and-low-risk-compartments" class="anchor"></a>Add High and Low Risk Compartments</h2>
<p>We are now going to make the model slightly more realistic, and therefore better able to capture the observed dynamics of TB. We are going to do this by adding a second latent population. Go back to <a href="https://bristolmathmodellers.github.io/biddmodellingcourse/articles/practical_1.html">practical 1</a> if you need a refresher for the motivation behind this.</p>
<div id="populations-and-initialisation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#populations-and-initialisation-1" class="anchor"></a>Populations and Initialisation</h3>
<p>As in the previous model the first step is to define the model populations. There are now two new compartments, high risk latents (H), and low risk latents (L). These replace the orginal latent population (E) used in the previous model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SHILR_inits =<span class="st"> </span><span class="kw">c</span>(
  <span class="dt">S =</span> <span class="dv">999</span>,
  <span class="dt">H =</span> <span class="dv">0</span>,
  <span class="dt">L =</span> <span class="dv">0</span>,
  <span class="dt">I =</span> <span class="dv">1</span>,
  <span class="dt">R =</span> <span class="dv">0</span>
)</code></pre></div>
</div>
<div id="parameters-1" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters-1" class="anchor"></a>Parameters</h3>
<p>We add two additional parameters for the rate of progression from high to low risk latents (nu) and the rate of progression from low risk latent to active disease.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SHILR_parameters &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="dt">beta =</span> <span class="dv">3</span>, <span class="co"># Rate of transmission</span>
  <span class="dt">gamma_H =</span> <span class="dv">2</span>, <span class="co"># Rate of progression to active symptoms from high risk latent</span>
  <span class="dt">nu =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="co">#Rate of progression from high to low risk latent</span>
  <span class="dt">gamme_L =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">100</span>, <span class="co"># Rate of progression to active symptoms for low risk latent</span>
  <span class="dt">tau =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="co"># Rate of recovery</span>
  <span class="dt">mu =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">81</span> <span class="co"># Rate of natural mortality</span>
)</code></pre></div>
</div>
<div id="equations-1" class="section level3">
<h3 class="hasAnchor">
<a href="#equations-1" class="anchor"></a>Equations</h3>
<p>The code below is a starting point, fill in the missing model terms using the following model flow diagram and the code for the previous SEIR model as reference points.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SHLIR_demo_ode &lt;-<span class="st"> </span><span class="cf">function</span>(t, x, params) {

  ## Specify model compartments
  S &lt;-<span class="st"> </span>x[<span class="dv">1</span>]
  H &lt;-<span class="st"> </span>x[<span class="dv">2</span>]
  L &lt;-<span class="st"> </span>x[<span class="dv">3</span>]
  I &lt;-<span class="st"> </span>x[<span class="dv">4</span>]
  R &lt;-<span class="st"> </span>x[<span class="dv">5</span>]

  <span class="kw">with</span>(<span class="kw">as.list</span>(params),{

    ## Specify total population
    N =<span class="st"> </span>S <span class="op">+</span><span class="st"> </span>H <span class="op">+</span><span class="st"> </span>L <span class="op">+</span><span class="st"> </span>I <span class="op">+</span><span class="st"> </span>R

    ## Derivative Expressions
    dS =<span class="st"> </span><span class="op">-</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>S <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>N
    ## These are the new equations - fill in the remaining terms
    dH =<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>(S <span class="op">+</span><span class="st"> </span>L) <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N 
    dL =<span class="st">  </span><span class="op">-</span><span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>L <span class="op">*</span><span class="st"> </span>I <span class="op">/</span><span class="st"> </span>N
    ## Hint terms are missing from this equation as well
    dI =<span class="st">  </span><span class="op">-</span><span class="st"> </span>tau <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>I
    dR =<span class="st"> </span>tau <span class="op">*</span><span class="st"> </span>I <span class="op">-</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>R

    ## output
    derivatives &lt;-<span class="st"> </span><span class="kw">c</span>(dS, dH, dL, dI, dR)

    <span class="kw">list</span>(derivatives)
  })
}</code></pre></div>
</div>
<div id="simulate-and-summarise-1" class="section level3">
<h3 class="hasAnchor">
<a href="#simulate-and-summarise-1" class="anchor"></a>Simulate and Summarise</h3>
<p>Simulation is the same as for the previous model. Does the simulation of your improved model make sense? Evaluate the summary tables and plot of model populations over time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">begin_time &lt;-<span class="st"> </span><span class="dv">0</span>
end_time &lt;-<span class="st"> </span><span class="dv">200</span>
SHILR_times &lt;-<span class="st"> </span><span class="kw">seq</span>(begin_time, end_time, <span class="dv">1</span>)

## see ?solve_ode for details
SEIR_sim &lt;-<span class="st"> </span>biddmodellingcourse<span class="op">::</span><span class="kw"><a href="https://bristolmathmodellers.github.io/biddmodellingcourse//reference/solve_ode.html">solve_ode</a></span>(<span class="dt">model =</span> SHLIR_demo_ode, 
                                           <span class="dt">inits =</span> SHLIR_inits, 
                                           <span class="dt">params =</span> SHLIR_parameters,
                                           <span class="dt">times =</span> SHILR_times, 
                                           <span class="dt">as.data.frame =</span> <span class="ot">TRUE</span>)
SHLIR_sim <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>head <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/prettypublisher/topics/pretty_table">pretty_table</a></span>(<span class="dt">caption =</span> <span class="st">"First 5 years of SHLIR model simulation"</span>,
               <span class="dt">label =</span> <span class="st">"tab-1"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">biddmodellingcourse<span class="op">::</span><span class="kw"><a href="https://bristolmathmodellers.github.io/biddmodellingcourse//reference/summarise_model.html">summarise_model</a></span>(SEIR_sim) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/prettypublisher/topics/pretty_table">pretty_table</a></span>(<span class="dt">caption =</span> <span class="st">"SHLIR model summary statistics; The final size of each population at the end of the simulation, along with the time the epidemic peak was reached, the number of infected at the epidemic peak and the duration of the epidemic"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## For an interactive graph change interactive to TRUE
biddmodellingcourse<span class="op">::</span><span class="kw"><a href="https://bristolmathmodellers.github.io/biddmodellingcourse//reference/plot_model.html">plot_model</a></span>(SEIR_sim, <span class="dt">interactive =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
</div>
<div id="explore-1" class="section level2">
<h2 class="hasAnchor">
<a href="#explore-1" class="anchor"></a>Explore</h2>
<ol style="list-style-type: decimal">
<li><p>How do the model dynamics for this model differ for different parameter values?</p></li>
<li><p>What has the impact of adding the second latent population been?</p></li>
</ol>
</div>
<div id="extension-translate-your-model-flow-diagram-to-equations" class="section level2">
<h2 class="hasAnchor">
<a href="#extension-translate-your-model-flow-diagram-to-equations" class="anchor"></a>Extension: Translate your Model Flow Diagram to Equations</h2>
<ul>
<li>basic model outline</li>
<li>suggestions for order in which to add complexity</li>
</ul>
</div>
<div id="extension-explore-the-parameter-space-of-multiple-models" class="section level2">
<h2 class="hasAnchor">
<a href="#extension-explore-the-parameter-space-of-multiple-models" class="anchor"></a>Extension: Explore the Parameter Space of Multiple Models</h2>
<ul>
<li>link to shiny app</li>
<li>help with shiny app</li>
<li>question ideas</li>
</ul>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#learning-objectives">Learning Objectives</a></li>
      <li><a href="#outline-for-session">Outline for Session</a></li>
      <li>
<a href="#excercises">Excercises</a><ul class="nav nav-pills nav-stacked">
<li><a href="#a-simple-seir-model-of-tuberculosis-tb">A Simple SEIR Model of Tuberculosis (TB)</a></li>
      <li><a href="#add-high-and-low-risk-compartments">Add High and Low Risk Compartments</a></li>
      <li><a href="#explore-1">Explore</a></li>
      <li><a href="#extension-translate-your-model-flow-diagram-to-equations">Extension: Translate your Model Flow Diagram to Equations</a></li>
      <li><a href="#extension-explore-the-parameter-space-of-multiple-models">Extension: Explore the Parameter Space of Multiple Models</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Josephine Walker, Ellen Brooks-Pollock.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
